<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.demo.domain.member.mapper.MemberMapper">
    
    <select id="findAll" resultType="Member">
		SELECT 
		    id
		    , name
		    , email
		FROM 
		    Member
    </select>
    
    <select id="search" parameterType="MemberRequestDto" resultType="Member">
		SELECT 
		    id
		    , name
		    , email
		FROM 
		    Member
		<where>
		    <if test="searchKeyword != null and searchKeyword != ''">
		        <choose>
		            <when test="searchType == 'id'">
		                AND id like CONCAT('%', #{searchKeyword, jdbcType=VARCHAR}, '%')
		            </when>
		            <when test="searchType == 'name'">
		                AND name like CONCAT('%', #{searchKeyword, jdbcType=VARCHAR}, '%')
		            </when>
		            <when test="searchType == 'email'">
		                AND email like CONCAT('%', #{searchKeyword, jdbcType=VARCHAR}, '%')
		            </when>
		        </choose>
		    </if>
		</where>
    </select>
    
    <select id="findById" parameterType="String" resultType="Member">
		SELECT 
		    id
		    , name
		    , email
		FROM 
		    Member
		WHERE 
		    id = #{id}
    </select>
    
    <insert id="insert" parameterType="Member">
		INSERT INTO Member (
		    id
		    , name
		    , email
		) VALUES (
		    #{id}
		    , #{name}
		    , #{email}
		)
    </insert>
    
    <update id="update" parameterType="Member">
		UPDATE Member 
		SET 
		    name = #{name}
		<if test="email != null and email != ''">
		    , email = #{email}
		</if>
		WHERE 
		    id = #{id}
    </update>
    
    <delete id="delete" parameterType="String">
		DELETE
		FROM 
		    Member 
		WHERE 
		    id = #{id}
    </delete>
</mapper>